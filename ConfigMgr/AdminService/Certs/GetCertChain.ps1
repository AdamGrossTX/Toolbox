$Cert | Select *

#This is just for testing
#$RootCertString = "308203333082021BA00302010202102ADD16574C0450A440AC012FD59EC567300D06092A864886F70D01010B05003016311430120603550403130B534D532049737375696E67301E170D3139303131353137353234395A170D3231303131353137353234395A3016311430120603550403130B534D532049737375696E6730820122300D06092A864886F70D01010105000382010F003082010A02820101009F5C1FD16B2D0FC5F55560098F18B2FD6D88CAAEFD82978FE79C2860AB2C1F1399954D2A15707CA8EEC11DDE69CC1D3577D63BF63799519FD9D83B848EDEE92A3FDD35898BB8FDBFDEE5C37C75BE0D47D149377867A21CE8562C0F6D73DA6DA948B15DB37A3D8B30FC55CDC6A49AECEB75C93548AEAABE3DC639DC0F7D2FF39DB040F238EE24AAC22D89D9DBA1E786D52659CAD785C0A63A09EB6D469D2E475D7CEE347986B93E7AD509FA480BB33D2F8B4665E1A3FF61634C535309745569E84BDD387464BC9D3014FE7132AE0046477169E59A42F2843BFC86F3218406AF24AAB944EDD21F8816AA99B4DB0061BE1D0D7AEF9DDB1B0233D6438E2CA410FBA70203010001A37D307B300E0603551D0F0101FF040403020284300F0603551D130101FF040530030101FF301C06082A864886F714050604107BCEBC894ECC8F45A3F97E5BE4ADEF9E301C06082A864886F714050B0410FAA224589960524F95DAE122857124E9301C06082A864886F71405040410312AFD1907E3D14883A6F44D290C9721300D06092A864886F70D01010B050003820101007E4C4A6107C888F00468FB133319FCEB2A327DC73F121D8AB405DA9657B43CA01EB0E0187E52801285EB862B71B028C2F8204EB2138FDA26F3DE7C738F02968945783DE6E8D707C139FAF67FA6FAB4E2CD26D610BC8B4F66B8A4A3649ED21560353E3EBA6E47165A3B8ED8F12C6FEDF5E6E42074989EA9CB08546F402544A737C5AC583F38B41A92F710FFCD06029D0DABB0AF9C357EF585E5CC325181B60059128562ED73FE50BBB376412BD7745D9C9CA095368677409D1967CE9AE62FF00AFE350A0C55411E5922F6AA29A0681C8500CA230D4FA8DC03048480966582A9C0BBA3EC71FED91AE460D1B4D5B2FB6B360FB45A93C61AAD399147F4074737C686"

[Security.Cryptography.X509Certificates.X509Certificate2UI]::
        $certs = New-Object Security.Cryptography.X509Certificates.X509Certificate2Collection
        if ($IncludeAllCerts) {
            $chain = New-Object Security.Cryptography.X509Certificates.X509Chain
            $chain.ChainPolicy.RevocationMode = "NoCheck"
            [void]$chain.Build($Cert)

            $chain.ChainElements | ForEach-Object {[void]$certs.Add($_.Certificate)}
            $chain.Reset()
        } else {
            [void]$certs.Add($Certificate)
        }

        $Cert.

        $chain.ChainElements[0].Certificate
        $rootCert = $chain.ChainElements[1].Certificate.GetRawCertDataString()

        $RootCert -eq $RootCertString
        